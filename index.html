<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHUG-O-MATIC 3000</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Roboto+Mono:wght@700&display=swap');

        :root {
            --neon-green: #39ff14;
            --toxic-yellow: #ffff00;
            --alert-red: #ff0000;
        }

        body {
            font-family: 'Roboto Mono', monospace;
            background-color: #050505;
            color: var(--neon-green);
            overflow-x: hidden;
            height: 100vh;
            /* Subtle Scanline effect */
            background-image: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            background-size: 100% 2px, 3px 100%;
        }

        /* Glitch overlay - Reduced opacity for readability */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.05) 50%, rgba(0,0,0,0.05));
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 50;
        }

        /* Hazard stripe background for active state */
        body.chug-mode {
            background: repeating-linear-gradient(
                45deg,
                #000,
                #000 20px,
                #1a0000 20px,
                #1a0000 40px
            );
            /* Removed the contrast strobe to help readability */
        }

        .wheel-container {
            position: relative;
            width: 320px;
            height: 320px;
            margin: 0 auto;
            filter: drop-shadow(0 0 10px var(--neon-green));
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            border: 8px solid #222;
            box-sizing: border-box;
            overflow: hidden;
        }

        .pointer {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid var(--toxic-yellow);
            z-index: 20;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.8));
        }

        .segment-label {
            position: absolute;
            top: 50%;
            left: 50%;
            /* Removed transforms here, handled in JS */
            color: #000;
            font-family: 'Black Ops One', cursive;
            font-size: 3.5rem; /* Larger text */
            text-shadow: 2px 2px 0px rgba(255,255,255,0.3);
            pointer-events: none;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            /* Center the pivot point */
            margin-top: -30px; 
            margin-left: -30px;
            z-index: 10;
        }

        .hub {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: #000;
            border: 4px solid var(--neon-green);
            border-radius: 50%;
            z-index: 15;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .timer-display {
            font-family: 'Black Ops One', cursive;
            font-variant-numeric: tabular-nums;
            letter-spacing: 2px;
            text-shadow: 2px 2px 0px #000;
        }

        /* Readable Shake - No Rotation to prevent blurring */
        @keyframes violent-shake {
            0% { transform: translate(0, 0); }
            25% { transform: translate(-8px, 8px); }
            50% { transform: translate(8px, -8px); }
            75% { transform: translate(-8px, -8px); }
            100% { transform: translate(0, 0); }
        }

        .shaking {
            animation: violent-shake 0.15s infinite;
        }

        /* Word Popups */
        .word-pop {
            position: absolute;
            font-family: 'Black Ops One', cursive;
            font-size: 5rem;
            color: white;
            text-shadow: 4px 4px 0px #000;
            -webkit-text-stroke: 2px black;
            animation: pop-fade 0.6s forwards;
            pointer-events: none;
            z-index: 100;
            font-weight: 900;
        }

        @keyframes pop-fade {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }

        .glitch-text {
            animation: glitch-anim 3s infinite; /* Slower glitch */
        }

        @keyframes glitch-anim {
            0% { transform: skew(0deg); }
            95% { transform: skew(0deg); }
            96% { transform: skew(-5deg); }
            97% { transform: skew(5deg); }
            98% { transform: skew(-5deg); }
            100% { transform: skew(0deg); }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center p-4">

    <div class="scanlines"></div>

    <div id="main-ui" class="w-full max-w-lg relative z-10 text-center">
        
        <h1 class="text-5xl md:text-6xl mb-8 glitch-text font-black text-transparent bg-clip-text bg-gradient-to-t from-green-500 to-green-300 drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)]">
            CHUG-O-MATIC
        </h1>

        <div class="wheel-container mb-8" id="wheel-container">
            <div class="pointer"></div>
            <div class="wheel bg-black" id="wheel">
                <div class="hub">ðŸ’€</div>
            </div>
        </div>

        <div class="bg-zinc-900 border-4 border-green-600 p-6 shadow-2xl transform transition-all relative" id="control-panel">
            <div id="status-text" class="text-xl font-black mb-3 tracking-widest text-yellow-400 drop-shadow-md">INITIATE SEQUENCE</div>
            
            <div class="relative h-32 flex items-center justify-center bg-black border-4 border-gray-700 mb-6 rounded-lg shadow-inner">
                <div id="timer-display" class="text-7xl font-black text-red-500 timer-display relative z-10">0.00</div>
            </div>

            <button id="spin-btn" onclick="spinSequence()" 
                class="w-full bg-green-600 hover:bg-green-500 text-black font-black text-2xl py-6 uppercase tracking-tight border-b-8 border-green-800 active:border-b-0 active:translate-y-2 transition-all shadow-lg rounded">
                PULL THE LEVER
            </button>
            
            <p class="mt-4 text-xs text-gray-500 uppercase font-bold">Extreme Mode Active</p>
        </div>

    </div>

    <script>
        const segments = [
            { number: 1, color: '#ff3d6a' }, // Red
            { number: 2, color: '#ff78ff' }, // Pink
            { number: 3, color: '#ffff2e' }, // Yellow
            { number: 4, color: '#d4ff2e' }, // Volt
            { number: 5, color: '#2eff2e' }  // Green
        ];

        const wheel = document.getElementById('wheel');
        const wheelContainer = document.getElementById('wheel-container');
        const spinBtn = document.getElementById('spin-btn');
        const timerDisplay = document.getElementById('timer-display');
        const statusText = document.getElementById('status-text');
        const controlPanel = document.getElementById('control-panel');
        
        let currentRotation = 0;
        let isSpinning = false;
        let timerInterval = null;

        function initWheel() {
            const segmentAngle = 360 / segments.length;
            let gradientString = 'conic-gradient(';

            segments.forEach((seg, index) => {
                const startAngle = index * segmentAngle;
                const endAngle = (index + 1) * segmentAngle;
                gradientString += `${seg.color} ${startAngle}deg ${endAngle}deg, `;

                const label = document.createElement('div');
                label.className = 'segment-label';
                label.textContent = seg.number;
                
                // --- FIXED CENTERING LOGIC ---
                // We use transform chaining: 
                // 1. Rotate to the center of the segment
                // 2. Push out by radius (translateY)
                // 3. Counter-rotate so text stays readable (or aligned)
                
                const midAngle = startAngle + (segmentAngle / 2);
                const radius = 100; // Distance from center
                
                // Note: CSS conic-gradient starts at 12 o'clock (0deg).
                // TranslateY(-radius) moves it UP towards 12 o'clock.
                label.style.transform = `rotate(${midAngle}deg) translate(0, -${radius}px) rotate(${-midAngle}deg)`;
                
                wheel.appendChild(label);
            });

            gradientString = gradientString.slice(0, -2) + ')';
            wheel.style.background = gradientString;
        }

        function spinSequence() {
            if (isSpinning) return;
            
            stopTimer();
            isSpinning = true;
            spinBtn.disabled = true;
            spinBtn.innerText = "LOCKED IN";
            spinBtn.classList.add('opacity-50', 'cursor-not-allowed');
            statusText.innerText = "WINDING UP...";
            statusText.className = "text-xl font-black mb-3 tracking-widest text-red-500";

            // 1. Wind Up (Backwards rotation)
            const windUpAngle = currentRotation - 60; 
            wheel.style.transition = "transform 1s cubic-bezier(0.6, -0.28, 0.735, 0.045)";
            wheel.style.transform = `rotate(${windUpAngle}deg)`;

            // 2. The Launch
            setTimeout(() => {
                statusText.innerText = "CRITICAL VELOCITY";
                
                const resultIndex = Math.floor(Math.random() * segments.length);
                const resultValue = segments[resultIndex].number;
                
                const segmentAngle = 360 / segments.length;
                const segmentCenter = (resultIndex * segmentAngle) + (segmentAngle / 2);
                const targetRotation = (360 - segmentCenter);
                
                const totalSpins = 360 * 10; // Slightly fewer spins for cleaner stop
                // Ensure we land strictly on target logic
                const nextRotation = windUpAngle + totalSpins + targetRotation - (windUpAngle % 360);
                
                // Add tiny jitter for realism, but keep it centered in wedge
                const jitter = (Math.random() * 20) - 10; 
                
                currentRotation = nextRotation + jitter;

                wheel.style.transition = "transform 3s cubic-bezier(0.1, 1, 0.2, 1)";
                wheel.style.transform = `rotate(${currentRotation}deg)`;

                // Shake panel briefly on launch
                controlPanel.classList.add('shaking');
                setTimeout(() => controlPanel.classList.remove('shaking'), 400);

                // 3. Finish
                setTimeout(() => {
                    isSpinning = false;
                    startExtremeTimer(resultValue);
                }, 3000);

            }, 1000); 
        }

        function startExtremeTimer(seconds) {
            document.body.classList.add('chug-mode');
            controlPanel.classList.add('shaking'); 
            spinBtn.classList.add('hidden');
            
            statusText.innerText = "DRINK!";
            statusText.style.color = "#FF0000";
            statusText.style.fontSize = "3rem";
            
            let timeLeft = seconds * 1000; 
            
            const wordInterval = setInterval(() => {
                const words = ["GULP", "CHUG", "GO!", "FASTER", "DRINK", "AAA!!!"];
                showFloatingWord(words[Math.floor(Math.random() * words.length)]);
            }, 800);

            timerInterval = setInterval(() => {
                timeLeft -= 17; 
                
                if (timeLeft >= 0) {
                    timerDisplay.innerText = (timeLeft / 1000).toFixed(2);
                    
                    if(timeLeft < 1500) {
                        timerDisplay.style.color = "#FFF"; // Flash white near end
                    } else {
                        timerDisplay.style.color = "#ef4444";
                    }
                } else {
                    clearInterval(timerInterval);
                    clearInterval(wordInterval);
                    finishSequence();
                }
            }, 17);
        }

        function finishSequence() {
            document.body.classList.remove('chug-mode');
            controlPanel.classList.remove('shaking');
            timerDisplay.innerText = "DONE";
            timerDisplay.style.color = "#39ff14";
            
            statusText.innerText = "COMPLETE";
            statusText.style.color = "#39ff14";
            statusText.style.fontSize = "1.5rem";
            
            spinBtn.disabled = false;
            spinBtn.classList.remove('hidden', 'opacity-50', 'cursor-not-allowed');
            spinBtn.innerText = "NEXT ROUND";
            
            showFloatingWord("NICE");
        }

        function stopTimer() {
            if (timerInterval) clearInterval(timerInterval);
            document.body.classList.remove('chug-mode');
            controlPanel.classList.remove('shaking');
            timerDisplay.innerText = "0.00";
            timerDisplay.style.color = "#ef4444";
            statusText.style.fontSize = "1.25rem";
        }

        function showFloatingWord(text) {
            const el = document.createElement('div');
            el.className = 'word-pop';
            el.innerText = text;
            
            // Centralized random positioning
            const x = Math.random() * 60 + 20; // Keep somewhat central
            const y = Math.random() * 60 + 20;
            
            el.style.left = x + '%';
            el.style.top = y + '%';
            // Random rotation for word
            el.style.transform = `rotate(${(Math.random() * 40) - 20}deg)`;
            
            el.style.color = Math.random() > 0.5 ? '#ffff00' : '#ffffff';
            
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 1000);
        }

        initWheel();
    </script>
</body>
</html>
